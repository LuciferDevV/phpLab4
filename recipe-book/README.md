# Отчет по лабораторной работе 4

## Инструкция по запуску проекта

### Установка

1. Убедитесь, что у вас установлен PHP. Вы можете проверить это с помощью команды:
   ```bash
   php -v
   ```

2. Для запуска локального сервера перейдите в корневую директорию проекта `recipe-book` и выполните команду:
   ```bash
   php -S localhost:5051
   ```

3. Откройте в браузере URL:
   ```bash
   http://localhost:5051/
   ```

Теперь вы сможете использовать проект "Книга рецептов".

---

## Описание лабораторной работы

Целью лабораторной работы является создание простого веб-приложения для добавления, отображения и хранения рецептов. В процессе работы было освоено использование HTML-форм, обработка данных с помощью PHP, валидация и фильтрация введённых данных, а также сохранение данных в текстовом файле с использованием формата JSON.

Приложение состоит из нескольких частей:
- **Главная страница** (index.php) — отображает последние два рецепта.
- **Страница создания рецепта** (create.php) — форма для добавления нового рецепта.
- **Страница со списком всех рецептов** (list.php) — выводит все рецепты из файла.

Обработка отправленных форм выполняется в отдельном обработчике (`src/handlers/submit.php`), а логика сохранения и валидации вынесена в модуль `core.php`.  
Данные рецептов сохраняются в файл `storage/recipes.txt` в формате JSON, и при каждом добавлении нового рецепта файл обновляется.

---

## Краткая документация к проекту

### Структура проекта

```
recipe-book/
├── public/                          
│   ├── index.php                    # Главная страница (вывод последних рецептов)
│   └── recipe/                      
│       ├── create.php               # Форма добавления рецепта
│       └── list.php                 # Страница с отображением рецептов
├── src/                             
│   ├── core.php                     # Логика обработки данных
│   ├── helpers.php                  # Вспомогательные функции для обработки данных
│   └── handlers/
│       └── submit.php               # Хандлер обработки формы
├── storage/                         
│   └── recipes.txt                  # Файл для хранения рецептов
└── README.md                        # Описание проекта
```

### Основные компоненты

- **index.php**: Главная страница, где отображаются последние два рецепта.
  
  Пример:
  ```php
  <?php
  $recipes = getAllRecipes();
  $latest = array_slice(array_reverse($recipes), 0, 2);
  ```

- **create.php**: Страница с формой для добавления нового рецепта.  
  При загрузке страницы подключается `submit.php`, который обрабатывает отправку формы. Это позволяет централизовать обработку POST-запросов.

  Пример:
  ```php
  <?php require_once __DIR__ . '/../../src/handlers/submit.php'; ?>
  <form method="POST">
      <label>Название: <input type="text" name="title" required></label><br><br>
      <button type="submit">Сохранить</button>
  </form>
  ```

- **list.php**: Страница с полным списком рецептов.

  Пример:
  ```php
  $recipes = getAllRecipes();
  foreach ($recipes as $recipe) {
      echo "<li>" . htmlspecialchars($recipe['title']) . "</li>";
  }
  ```

- **core.php**: Основной файл, содержащий бизнес-логику обработки, валидации и сохранения рецептов.

  Пример:
  ```php
  function handleRecipeSubmission(array $data) {
      $title = sanitizeInput($data['title']);
      // Другие поля: категория, описание, ингредиенты, шаги и т.д.
      $recipe = [ 'title' => $title /* и т.д. */ ];
      saveToFile(DATA_FILE, $recipe);
  }
  ```

- **handlers/submit.php**: Отдельный модуль-обработчик, подключаемый к `create.php`.  
  Выполняет проверку типа запроса и передаёт данные функции `handleRecipeSubmission()` для последующей обработки.

  Пример:
  ```php
  <?php
  require_once __DIR__ . '/../core.php';

  if ($_SERVER['REQUEST_METHOD'] === 'POST') {
      handleRecipeSubmission($_POST);
  }
  ```

- **helpers.php**: Содержит вспомогательные функции для фильтрации и подготовки данных, таких как очистка строк, проверка заполненности и т.д.

  Пример:
  ```php
  function sanitizeInput($data) {
      return htmlspecialchars(trim($data)); 
  }
  ```

---

## Примеры использования проекта

1. **Главная страница** (index.php):  
   При открытии отображаются два последних рецепта (если они есть).  
   Если рецептов нет, появляется сообщение "Пока рецептов нет."

2. **Форма добавления рецепта** (create.php):  
   Страница содержит HTML-форму с обязательными полями: название, категория, описание, ингредиенты, шаги.  
   Отправка формы приводит к обработке данных и сохранению нового рецепта в JSON-файл.

3. **Список всех рецептов** (list.php):  
   Отображает все сохранённые рецепты из `storage/recipes.txt`. У каждого рецепта выводится его название и прочая информация.

---

## Ответы на контрольные вопросы

1. **Какие методы HTTP применяются для отправки данных формы?**  
   Используется метод `POST`, так как он позволяет безопасно передавать данные формы на сервер и не отображает их в URL.

2. **Что такое валидация данных, и чем она отличается от фильтрации?**  
   - **Валидация** — это проверка данных на соответствие определённым условиям (например, заполненность полей, корректный формат email и т.п.).  
   - **Фильтрация** — это очистка данных от нежелательных символов или потенциально опасного содержимого (например, удаление HTML-тегов, экранирование спецсимволов).

3. **Какие функции PHP используются для фильтрации данных?**  
   - `trim()` — удаляет пробелы и символы переноса строк в начале и конце строки.  
   - `htmlspecialchars()` — предотвращает выполнение HTML/JS-кода в пользовательском вводе.  
   - `filter_var()` — используется для фильтрации и валидации данных по заданным фильтрам (например, `FILTER_VALIDATE_EMAIL`).

---

## Список использованных источников

- [PHP Documentation](https://www.php.net/docs.php) — Официальная документация PHP.  
- [HTML Forms](https://developer.mozilla.org/en-US/docs/Learn/Forms) — MDN Web Docs о HTML-формах.  
- [JSON in PHP](https://www.php.net/manual/en/book.json.php) — Работа с JSON в PHP.

---

Если хочешь, могу ещё собрать это в `.md`-файл или помочь с генерацией PDF.
